{% extends "base.html" %}
{% block title %}{{ title }} - Documentation Tool{% endblock %}
{% block content %}
<div class="page-flex">
    <aside class="sidebar" aria-label="Sections Sidebar">
        <h4 class="sidebar-title">{{ current_section|capitalize }}</h4>
        <ul class="folder-tree">
            {% import 'macros/sidebar_macros.html' as macros %}
            {{ macros.render_tree(doc_tree, 0, current_doc_path) }}
        </ul>
    </aside>
    <div class="page-main-container container" id="editor-panel" {% if not current_doc_path %}style="display:none;"{% endif %}>
        <form id="doc-form" autocomplete="off">
            <header class="editor-header">
                <input type="text" id="title" name="title" class="editor-title" placeholder="Document Title" required>
                <span id="autosave-status" class="autosave-status" style="margin-left:0.5em; color:#47d5d0; font-size:0.97em; display:none;">Saved</span>
            </header>
            <label for="section" style="font-size:0.97em; margin-bottom:0.2em;">Section/Folder:</label>
            <input type="text" id="section" name="section" placeholder="e.g. guides, tutorials, reference"
                style="font-size:0.97em; padding:0.25em 0.5em; margin-bottom:1em; border-radius: 6px; border: 1.5px solid #929aab; max-width: 220px;">
            <div class="editor-toolbar" style="gap:0.3em; margin-bottom:0.7em;">
                <!-- toolbar buttons here -->
                <button type="button" class="toolbar-btn" data-command="bold" title="Bold"><b>B</b></button>
                <button type="button" class="toolbar-btn" data-command="italic" title="Italic"><i>I</i></button>
                <button type="button" class="toolbar-btn" data-command="h2" title="Heading 2">H2</button>
                <button type="button" class="toolbar-btn" data-command="code" title="Code Block">{"</>"}</button>
                <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">• List</button>
                <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">1. List</button>
                <button type="button" class="toolbar-btn" data-command="createLink" title="Insert Link">🔗</button>
                <button type="button" class="toolbar-btn" data-command="insertImage" title="Insert Image">🖼️</button>
                <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="blockquote" title="Blockquote">❝</button>
                <button type="button" class="toolbar-btn" data-command="insertHorizontalRule" title="Horizontal Rule">―</button>
                <button type="button" class="toolbar-btn" data-command="undo" title="Undo">⎌</button>
                <button type="button" class="toolbar-btn" data-command="redo" title="Redo">⎌⎌</button>
            </div>
            <label for="tags" style="font-size:0.97em; margin-bottom:0.2em;">Tags:</label>
            <input type="text" id="tags" name="tags" placeholder="#python, #flask, #api"
                style="font-size:0.97em; padding:0.25em 0.5em; margin-bottom:1em; border-radius: 6px; border: 1.5px solid #929aab; max-width: 320px;">
            <label for="content" style="font-size:0.97em; margin-bottom:0.2em;">Content:</label>
            {% import 'macros/writing_space.html' as ws %}
            {{ ws.render_writing_space('', readonly=False) }}
            <textarea id="content" name="content" style="display:none;" required></textarea>
            <div class="editor-footer" style="margin-top:0.5em; color:#929aab; font-size:0.95em; text-align:right;">
                <span id="word-count">0 words</span>
            </div>
        </form>
    </div>
    {% if not current_doc_path %}
    <div class="page-main-container container" id="welcome-panel" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 60vh; background: linear-gradient(120deg, #d3d5fd 0%, #e6f4fa 100%); box-shadow: 0 4px 32px rgba(0,87,184,0.07); border: 1.5px solid #e3e6ee;">
        <div style="text-align: center; max-width: 600px;">
            <div style="font-size: 3.5rem; margin-bottom: 0.5em; color: #2563eb;">
                📚
            </div>
            <h1 style="font-size: 2.5em; font-weight: 800; color: #23272f; margin-bottom: 0.2em; letter-spacing: 0.01em;">
                Welcome to <span style="color: #2563eb;">Documentation Tool</span>
            </h1>
            <p style="font-size: 1.25em; color: #474a56; margin-bottom: 1.2em;">
                Your personal space for organized, beautiful, and always-accessible documentation.<br>
                Start by creating a new document or select one from the sidebar.
            </p>
            <a href="{{ url_for('new_document') }}" class="edit-btn" style="font-size: 1.15em; padding: 0.8em 2.2em; margin-bottom: 1.5em; box-shadow: 0 2px 8px rgba(0,87,184,0.10);">
                + Create New Document
            </a>
            <div style="margin-top: 2em; text-align: left; background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(71,74,86,0.06); padding: 1.5em 2em;">
                <h2 style="font-size: 1.2em; color: #2563eb; font-weight: 700; margin-bottom: 0.7em;">Features:</h2>
                <ul style="font-size: 1.08em; color: #474a56; line-height: 1.7; margin-left: 1.2em;">
                    <li>🗂️ Organize docs by sections/folders</li>
                    <li>🏷️ Tag and search for quick access</li>
                    <li>🌙 Toggle light/dark mode for comfort</li>
                    <li>📝 Rich text & code formatting</li>
                    <li>🔒 Your docs, your control</li>
                </ul>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
