{% extends "base.html" %}
{% block title %}Edit {{ title }} - Documentation Tool{% endblock %}
{% block content %}
<div class="page-flex" style="min-height: 100vh; width: 100vw; max-width: 100vw; margin: 0; padding: 0; display: flex; flex-wrap: nowrap; overflow: hidden;">
    <aside class="sidebar" style="height: 100vh; min-width: 220px; max-width: 320px; flex-shrink: 0; overflow-y: auto;" aria-label="Sections Sidebar">
        <h4 class="sidebar-title">{{ current_section|capitalize }}</h4>
        <!-- filepath: /Users/nkhader/projects/documentation_tool/documentation_tool/src/templates/edit.html -->
        <ul class="sidebar-list">
            {% for doc in section_docs %}
                <li class="file" style="--sidebar-indent:0">
                    <a href="{{ url_for('page', doc_path=doc.path) }}"
                       class="file-link{% if doc.path == current_doc_path %} active{% endif %}">
                        {{ doc.filename or doc.name }}
                    </a>
                </li>
            {% endfor %}
        </ul>
        <div class="sidebar-actions">
            <a href="{{ url_for('new_document') }}" class="edit-btn" style="margin-top:1em;">+ New Document</a>
        </div>
    </aside>
    <div class="page-main-container container" id="editor-panel" style="flex: 1 1 0; width: 100%; max-width: 100vw; min-width: 0; margin: 0; padding: 0 2vw 0 2vw; display: flex; flex-direction: column; justify-content: flex-start; overflow: auto; min-height: 100vh; box-sizing: border-box;">
        <main>
            <form method="post" id="doc-form" autocomplete="off" style="width: 100%;">
                <header class="editor-header">
                    <input type="text" id="title" name="title" class="editor-title"
                        value="{{ title if title else '' }}" required>
                    <span id="autosave-status" style="margin-left:0.5em; color:#47d5d0; font-size:0.97em; display:none;">Saved</span>
                </header>
                <label for="section" style="font-size:0.97em; margin-bottom:0.2em;">Section/Folder:</label>
                <input type="text" id="section" name="section" value="{{ current_section if current_section else '' }}"
                    placeholder="e.g. guides, tutorials, reference"
                    style="font-size:0.97em; padding:0.25em 0.5em; margin-bottom:1em; border-radius: 6px; border: 1.5px solid #929aab; max-width: 220px;">
                <div class="editor-toolbar" style="gap:0.3em; margin-bottom:0.7em;">
                    <!-- toolbar buttons here -->
                    <button type="button" class="toolbar-btn" data-command="bold" title="Bold"><b>B</b></button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="Italic"><i>I</i></button>
                    <button type="button" class="toolbar-btn" data-command="h2" title="Heading 2">H2</button>
                    <button type="button" class="toolbar-btn" data-command="code" title="Code Block">{"</>"}</button>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">‚Ä¢ List</button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">1. List</button>
                    <button type="button" class="toolbar-btn" data-command="createLink" title="Insert Link">üîó</button>
                    <button type="button" class="toolbar-btn" data-command="insertImage" title="Insert Image">üñºÔ∏è</button>
                    <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="blockquote" title="Blockquote">‚ùù</button>
                    <button type="button" class="toolbar-btn" data-command="insertHorizontalRule" title="Horizontal Rule">‚Äï</button>
                    <button type="button" class="toolbar-btn" data-command="undo" title="Undo">‚éå</button>
                    <button type="button" class="toolbar-btn" data-command="redo" title="Redo">‚éå‚éå</button>
                </div>
                <label for="tags" style="font-size:0.97em; margin-bottom:0.2em;">Tags:</label>
                <input type="text" id="tags" name="tags" value="{{ tags|default('') }}"
                    placeholder="#python, #flask, #api"
                    style="font-size:0.97em; padding:0.25em 0.5em; margin-bottom:1em; border-radius: 6px; border: 1.5px solid #929aab; max-width: 320px;">
                <label for="content" style="font-size:0.97em; margin-bottom:0.2em;">Content:</label>
                <div id="writing-space" class="writing-space" contenteditable="true" spellcheck="true" aria-label="Document content"
                    style="font-size:1.12em; min-height:40vh; padding:2em 1.5em; border-radius:14px; border:2px solid #47d5d0; background:#f8fafd; margin-bottom:1.5em; outline:none; box-shadow:0 2px 16px rgba(91,159,255,0.13); transition: border 0.2s, box-shadow 0.2s;">
                    {{ content|safe }}
                </div>
                <textarea id="content" name="content" style="display:none;" required>{{ content|safe }}</textarea>
                <div class="editor-footer" style="margin-top:0.5em; color:#929aab; font-size:0.95em; text-align:right;">
                    <span id="word-count">0 words</span>
                </div>
                <div style="display: flex; justify-content: flex-end; margin-top: 1.2em;">
                    <button type="submit" class="save-btn">Save</button>
                </div>
            </form>
        </main>
    </div>
    <aside class="markdown-help notebook-cheatsheet" style="min-width: 220px; max-width: 350px; flex-shrink: 0; overflow-y: auto;" aria-label="Markdown Cheatsheet">
        <!-- cheatsheet content -->
    </aside>
</div>
<style>
@media (max-width: 1200px) {
  .sidebar, .markdown-help.notebook-cheatsheet {
    display: none !important;
  }
  .page-main-container.container {
    padding: 0 1vw 0 1vw !important;
  }
}
@media (max-width: 700px) {
  .page-main-container.container {
    padding: 0 0.2vw 0 0.2vw !important;
  }
  .editor-header .editor-title {
    font-size: 1.2em !important;
  }
  #writing-space {
    font-size: 1em !important;
    padding: 1em 0.5em !important;
  }
}
</style>
{% endblock %}
